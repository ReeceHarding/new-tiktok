rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // Helper functions for basic checks
    function isAuthenticated() {
      return request.auth != null;
    }
    
    // Base rule - allow all read access
    match /{allPaths=**} {
      allow read: if true;  // Allow public read access to all files
      allow write: if isAuthenticated(); // Allow any authenticated user to write
    }
    
    // Video upload rules - very lenient
    match /videos/{userId}/{filename} {
      allow read, write: if true;  // Allow complete public access
    }
    
    // Thumbnail rules - very lenient
    match /thumbnails/{userId}/{filename} {
      allow read, write: if true;  // Allow complete public access
    }
    
    // Profile pictures - very lenient
    match /profilePictures/{userId}/{filename} {
      allow read, write: if true;  // Allow complete public access
    }
    
    // Temporary processing directory - still restricted for Cloud Functions
    match /processing/{userId}/{filename} {
      allow read: if true;
      allow write: if false; // Only Cloud Functions should write here
    }
  }
} 